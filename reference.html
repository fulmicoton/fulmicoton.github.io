<!DOCTYPE html><html lang="en"><head><link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css"><link rel="stylesheet" href="assets/markstrap.css"></head><body data-spy="scroll"><a href="https://github.com/poulejapon/potato"><img id="ribbon" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub"></a><div class="navbar navbar-fixed-top"><div class="navbar-inner"><div class="container"><ul class="nav"><li><a href="index.html">Home</a></li><li><a href="reference.html">Reference</a></li><li><a href="examples.html">Examples</a></li></ul></div></div></div><div id="container" class="site container-fluid"><div id="sectionList" class="span4"><div class="sidebar-nav"><ul class="nav nav-list"></ul></div></div><div class="span8 offset4 content"><h1>Object Model</h1>
<p><a href="http://travis-ci.org/#!/poulejapon/potato"><img src="https://secure.travis-ci.org/poulejapon/potato.png" alt="Build Status"></a>

</p>
<p>Potato is a CoffeeScript micro-framework focused
on composition. It relies on its own object model, whose syntax might recall that of an ORM.


</p>
<h2>Object composition</h2>
<p>To declare a model for a user profile, you would typically declare it as a composition of the information of name, age and address. Address itself will be the composition of a street/city/zipcode/state/country.

</p>
<pre><code class="lang-coffeescript">O = require <span class="string">'potato'</span>

Address = O.Potato
    components:
        street:  O.String
        city:    O.String
        zipcode: O.String

Profile = O.Potato
    components:
        name:    O.String
        address: Address
        age:     O.Int</code></pre>
<p>You may notice that this syntax also allows to inline the definition of a very simple composed object that is very unlikely to be reused. For instance :



</p>
<pre><code class="lang-coffeescript">O = require <span class="string">'potato'</span>

UserInformation = O.Potato
    components:
        name: O.Potato
            components:
                first_name: O.String
                last_name:  O.String
        age: O.Int
        address: Address</code></pre>
<p>Though this style is not really recommended for such a definition, this syntax comes very handful with the
deep-overriding feature described below.

</p>
<pre><code class="lang-coffeescript">O = require <span class="string">'potato'</span>.

UserInformation = O.Potato
    components:
        name: O.Potato
            components:
                first_name: O.String
                last_name:  O.String
        age:  O.Int
        address: Address</code></pre>
<h2>Inheritance, and deep-overriding.</h2>
<p> The children components of your potatoes may themselves have components and your potatoes might rapidly look like small tree-like structures of components. You might still want to extend it, and override a piece of functionality located slightly deeper than in the very first layer of this tree.

</p>
<p>Potato makes it possible for you to inherit from an object, and extend or override pretty much anything, wherever in this tree ; be that a component, a method, or a static property of a component.

</p>
<p>For instance, my address potato was assuming that my users were french. For international users I&#39;ll need
to at least add a state and a country mention.

</p>
<pre><code class="lang-coffeescript"><span class="comment"># ...</span>
<span class="comment"># here we added two new components</span>
<span class="comment"># to our Address object.</span>

InternationalAddress = Address
    components:
        state:   O.String
        country: O.String</code></pre>
<p>String (as well as all Literal types) has a static property called default that describes the default value
that should be produced on instantiation.

</p>
<p>Let&#39;s say we actually wanted to have &quot;USA&quot;, &quot;NY&quot;, &quot;New York City&quot; as the default values for the country and the state components. We could have written :

</p>
<pre><code class="lang-coffeescript"><span class="comment"># ...</span>
InternationalAddress = Address
    components:
        city:    O.String
            <span class="reserved">default</span>: <span class="string">"New York City"</span>
        state:   O.String
            <span class="reserved">default</span>: <span class="string">"NY"</span>
        country: O.String
            <span class="reserved">default</span>: <span class="string">"USA"</span></code></pre>
<h2>Static properties, methods, literals</h2>
<p>Your object may have static members. These are pretty like static members in C++ or python etc. They are accessible from the Potato itself, but not from its instances.

</p>
<p>The most obvious one is &quot;make&quot; which makes it possible to instantiate a potato.

</p>
<pre><code class="lang-coffeescript"><span class="comment">#</span>
<span class="comment"># This should make an address with : </span>
<span class="comment"># all our default values.</span>
<span class="comment">#</span>
address = InternationalAddress.make()</code></pre>
<p>You may define more static members using the 
&quot;static&quot; section prefix. For instance, Potato&#39;s Models have a JSON deserialization function which looks pretty much like this. 

</p>
<pre><code class="lang-coffeescript">Model = O.Potato
    static:
        fromJSON: (json)->
            @make JSON.parse json</code></pre>
<p>On the other hands methods are made to be called from 
objects.
A model also have a toJSON method, which looks like :

</p>
<pre><code class="lang-coffeescript">Model = O.Potato
    methods:
        toJSON: ->
            JSON.stringify @toData()</code></pre>
<p>As an helper, a static function is actually also magically created, taking the object to which it should be bound to as a first argument.

</p>
<p>Someone in fond of functional programming may write things such as 

</p>
<pre><code class="lang-coffeescript">map Model.toJSON, someListOfModels</code></pre>
<p>as an alternative to

</p>
<pre><code class="lang-coffeescript">model.toJSON() <span class="keyword">for</span> model <span class="keyword">in</span> someListOfModels</code></pre>
<h2>Knowing your components is a cool thing.</h2>
<p>Your objects are aware of their components and their types and that is a great things.

</p>
<p>Validation
Serialization
Generic forms</p>
</div></div><script src="assets/jquery.min.js" type="application/javascript"></script><script src="assets/bootstrap/js/bootstrap.min.js" type="application/javascript"></script><script src="assets/markstrap.js" type="application/javascript"></script><script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-31902957-1']);
_gaq.push(['_trackPageview']);
(function() {</script><var>ga = document.createElement('script');    ga.type = 'text/javascript'; ga.async = true;<ga class="src">= ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-    analytics.com/ga.js';</ga><var>s = document.getElementsByTagName('script')[0]    ; s.parentNode.insertBefore(ga, s);
})();</var></var></body></html>